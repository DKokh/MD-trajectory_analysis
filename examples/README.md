#  This is a collection of example recipes showing how to carry out particular tasks using MD-IFP scripts


##  Generation of the Interaction Fingerprint table for a set of MD trajectories obtained either from standard MD simulations or RAMD simulations
Most steps included in the present examples are also demonstrated in the JN IFP_generation_examples_TRAJ.ipynb
However, to analyze a large set of trajectories a simple python script is usually more useful.

This example provide a template script that, after small adjastment, can be used to generate IFPs for 
    (i) a single MD trajectory 
    (ii) a set of MD trajectories.
    (iii) a set of Equilibration MD trajectories and dissociation RAMD trajectries
All steps are also included in IFP.py, that can be adjasted for a particualr task

1. Prerequisite:
    - Python 3.X and a set of python libraries
        Alteratively, one can configure environment in anaconda using: conda env create -f IFP_trajectory.yml
    - Scripts directory containing Scripts/IFP_generation.py and Scripts/Trajectories.py 
    
2. Input data required:
    - trajectory file (possible formats: nc,dcd, xtc, trr )
    - pdb file of the system (for example, generated from the first frame)
    - ligand pdb file
    - ligand mol2 file (not all mol2 files can be read, files generated by MOEor Maestro are fine)
         
3. Procedure (all steps are also combined in the IFP.py script that can be adapted for a particular task )
 
    (i) define directory and template of trajectory names that will be searched and added to the object.
        for example, simulated equilibration and dissociation trajectories can be stored as follows:
        for equilibration:
        
        my_ligand/my_equilibration/my_replica1/md1.dcd
        my_ligand/my_equilibration/my_replica2/md2.dcd
        
        for dissociation:
        
        my_ligand/my_RAMD/my_replica1/my_trajectory1/md1.dcd
        my_ligand/my_RAMD/my_replica1/my_trajectory2/md2.dcd
        
        my_ligand/my_RAMD/my_replica2/my_trajectory1/md1.dcd
        my_ligand/my_RAMD/my_replica2/my_trajectory2/md2.dcd
        
        reference pdb file for teh system: 
        
        my_ligand/topology/my_ref.pdb
        
        mol2 and pdb files for the ligand:

        my_ligand/topology/my_ligand.pdb
        my_ligand/topology/my_ligand.mol2
  
    In this case we define input parameters as following:
    
    __________________________________
    
        DIR_all = "my_ligand/"
        eq = "my_equilibration/my_replic*"
        ramd = "my_RAMD/my_replic*"
        eq_tr ="my_trajec*/*.dcd"
        ramd_tr = "my_trajec*/*.dcd"
     __________________________________
     
     Note, that reference pdb file fo a system  and pdb/mol2 for a ligand are obligatory, while equilibration or ramd trajectory may be absent 
   
    (ii) Trajectory object is generated, which contains all information of equilibration and RAMD trajectories. Additionally, ligand structure and chemical properties will be analized
    
     __________________________________
     
        tr = trajectories(DIR_all,namd_tmpl= eq, ramd_tmpl= ramd,ligand_pdb=lig_pdb,pdb = ref_pdb,\
                          ligand_mol2=lig_mol2,namd_traj_tmpl = eq_tr,ramd_traj_tmpl = tamd_tr)                   
      __________________________________
      
     (iii) Defenition of a sub-system to be analyzed 
        several possibilities are given below. Ligand will be added automatically; by default only protein and ligand will be considered
     __________________________________
                               
        tr.sub_system = " protein  "                                              # only protein and ligand - default set
        tr.sub_system = " protein or (resname SOL HOH WAT G G3 G5 U5 C C3 MN)  "  # protein, ligand, solvent, RNA residues, and Mn ion
        tr.sub_system = " protein or (resname SOL HOH WAT )  "                    # protein, ligand, solvent, 
     __________________________________
     
     (iv) IFP generation           
       (a) for equilibration trajectories: 
              One can define whether water bridges and contact with lipd must be computed
     __________________________________
     
        tr.analysis_all_namd(WB_analysis = False, Lipids = [],auxi_selection = [],step_analysis=step, start_analysis=start)  
        IFP_table = tr.namd.IFP_save(DIR_all+ligand_name+"-IFP_3000.pkl")
     _________________________________
     
      (b) for RAMD trajectories first relative residence times are computed:
     __________________________________   

        tr.ramd.scan_ramd()
        tr.analysis_all_ramd(WB_analysis = False, Lipids = [],auxi_selection = [],step_analysis=step, start_analysis=start)
        IFP_table = tr.namd.IFP_save(DIR_all+ligand_name+"-IFP_3000.pkl")
        
    ___________________________________




