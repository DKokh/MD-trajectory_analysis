#  This is a collection example recipes of how to carry out particular tasks using MD-IFP scripts

#########################

## 1. Generation of the Interaction Fingerprint table from a set of MD trajectories obtained either from  the standard MD simulations or RAMD simulations : script IFP.py

1. Prerequisite:
    - Python 3.X and a set of python libraries
        Alteratively, one can configure environment in anaconda using: conda env create -f IFP_trajectory.yml
    - Scripts directory containing Scripts/IFP_generation.py and Scripts/Trajectories.py 
    - Input data required:
         trajectory file (possible formats: nc,dcd, xtc, trr )
         pdb file of the system (for example, generated from the first frame)
         ligand pdb file
         ligand mol2 file (not all mol2 files can be read, files generated by MOEor Maestro are fine)
         
2. Usage:
     python IFP.py

3. Output:
    
#-----------------------------------------------------------------

    tr = trajectories(DIR_all,namd_tmpl= trj, ramd_tmpl= DIR_all,ligand_pdb=ligand_pdb,pdb = ref_pdb,\
                          ligand_mol2=ligand_mol2,namd_traj_tmpl = "*nc",ramd_traj_tmpl = "xx")
                          
    tr.sub_system = " protein or (resname SOL HOH WAT G G3 G5 U5 C C3 MN) "

    tr.analysis_all_namd(WB_analysis = False, Lipids = [],auxi_selection = [],step_analysis=step, start_analysis=start)

    IFP_table = tr.namd.IFP_save(DIR_all+ligand_name+"-IFP_3000.pkl")

#--------------------------------------------------------------------


